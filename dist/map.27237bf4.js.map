{"version":3,"sources":["map.js"],"names":["mapboxgl","accessToken","map","Map","on","e","addLayer","stores","buildLocationList","features","queryRenderedFeatures","point","length","clickedPoint","flyToStore","createPopUp","activeItem","document","getElementsByClassName","classList","remove","selectedFeature","properties","address","i","selectedFeatureIndex","listing","getElementById","add","data","currentFeature","prop","listings","appendChild","createElement","className","id","link","href","dataPosition","innerHTML","details","city","phone","phoneFormatted","addEventListener","clickedListing","parentNode","flyTo","geometry","coordinates","popUps","popup","Popup","setLngLat","setHTML","addTo","Element","prototype","removeChild"],"mappings":"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","file":"map.27237bf4.js","sourceRoot":"..","sourcesContent":["mapboxgl.accessToken = 'pk.eyJ1IjoibWFjYW5pY2EiLCJhIjoiY2p0cDkyY3J6MDI4MTN5cGx0dXhtNXpyaCJ9.3OVQDTl8MJQ2HkywQgSV5w';\n// This adds the map to your page\nvar map = new mapboxgl.Map({\n    // container id specified in the HTML\n    'container': 'map',\n    // style URL\n    'style': 'mapbox://styles/mapbox/light-v10',\n    // initial position in [lon, lat] format\n    'center': [ -77.034084, 38.909671 ],\n    // initial zoom\n    'zoom': 14\n});\n\nmap.on('load', function(e){\n    // Add the data to your map as a layer\n    map.addLayer({\n        'id': 'locations',\n        'type': 'symbol',\n        // Add a GeoJSON source containing place coordinates and information.\n        'source': {\n            'type': 'geojson',\n            'data': stores\n        },\n        'layout': {\n            'icon-image': 'restaurant-15',\n            'icon-allow-overlap': true,\n        }\n    });\n    buildLocationList(stores);\n});\n\n// Add an event listener for when a user clicks on the map\nmap.on('click', function(e){\n    // Query all the rendered points in the view\n    var features = map.queryRenderedFeatures(e.point, { 'layers': [ 'locations' ] });\n\n    if(features.length){\n        var clickedPoint = features[0];\n        // 1. Fly to the point\n\n        flyToStore(clickedPoint);\n        // 2. Close all other popups and display popup for clicked store\n        createPopUp(clickedPoint);\n        // 3. Highlight listing in sidebar (and remove highlight for all other listings)\n        var activeItem = document.getElementsByClassName('active');\n\n        if(activeItem[0]){\n            activeItem[0].classList.remove('active');\n        }\n        // Find the index of the store.features that corresponds to the clickedPoint that fired the event listener\n        var selectedFeature = clickedPoint.properties.address;\n\n        for(var i = 0; i < stores.features.length; i++){\n            if(stores.features[i].properties.address === selectedFeature){\n                selectedFeatureIndex = i;\n            }\n        }\n        // Select the correct list item using the found index and add the active class\n        var listing = document.getElementById('listing-' + selectedFeatureIndex);\n\n        listing.classList.add('active');\n    }\n});\n\nfunction buildLocationList(data){\n    // Iterate through the list of stores\n    for(i = 0; i < data.features.length; i++){\n        var currentFeature = data.features[i];\n        // Shorten data.feature.properties to `prop` so we're not\n        // writing this long form over and over again.\n        var prop = currentFeature.properties;\n        // Select the listing container in the HTML and append a div\n        // with the class 'item' for each store\n        var listings = document.getElementById('listings');\n        var listing = listings.appendChild(document.createElement('div'));\n\n        listing.className = 'item';\n        listing.id = 'listing-' + i;\n\n        // Create a new link with the class 'title' for each store\n        // and fill it with the store address\n        var link = listing.appendChild(document.createElement('a'));\n\n        link.href = '#';\n        link.className = 'title';\n        link.dataPosition = i;\n        link.innerHTML = prop.address;\n\n        // Create a new div with the class 'details' for each store\n        // and fill it with the city and phone number\n        var details = listing.appendChild(document.createElement('div'));\n\n        details.innerHTML = prop.city;\n        if(prop.phone){\n            details.innerHTML += ' Â· ' + prop.phoneFormatted;\n        }\n    }\n}\n\n// Add an event listener for the links in the sidebar listing\nlink.addEventListener('click', function(e){\n    // Update the currentFeature to the store associated with the clicked link\n    var clickedListing = data.features[this.dataPosition];\n    // 1. Fly to the point associated with the clicked link\n\n    flyToStore(clickedListing);\n    // 2. Close all other popups and display popup for clicked store\n    createPopUp(clickedListing);\n    // 3. Highlight listing in sidebar (and remove highlight for all other listings)\n    var activeItem = document.getElementsByClassName('active');\n\n    if(activeItem[0]){\n        activeItem[0].classList.remove('active');\n    }\n    this.parentNode.classList.add('active');\n});\n\nfunction flyToStore(currentFeature){\n    map.flyTo({\n        'center': currentFeature.geometry.coordinates,\n        'zoom': 15\n    });\n}\n\nfunction createPopUp(currentFeature){\n    var popUps = document.getElementsByClassName('mapboxgl-popup');\n    // Check if there is already a popup on the map and if so, remove it\n\n    if(popUps[0]){\n        popUps[0].remove();\n    }\n\n    var popup = new mapboxgl.Popup({ 'closeOnClick': false })\n        .setLngLat(currentFeature.geometry.coordinates)\n        .setHTML('<h3>Sweetgreen</h3>' +\n            '<h4>' + currentFeature.properties.address + '</h4>')\n        .addTo(map);\n}\n\n\n// This will let you use the .remove() function later on\nif(!('remove' in Element.prototype)){\n    Element.prototype.remove = function(){\n        if(this.parentNode){\n            this.parentNode.removeChild(this);\n        }\n    };\n}\n"]}